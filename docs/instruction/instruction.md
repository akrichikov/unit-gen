---
layout: default
title: Instruction Builder
nav_order: 4
has_children: true
permalink: /instruction
---

Unit Eval with combined with CodeContextStrategy and CompletionBuilderType to build the instruction.

The instructions will be generated by the following steps:

|                      | SimilarChunks | RelatedCode |
|----------------------|---------------|-------------|
| InlineCompletion     |               |             |
| InBlockCompletion    |               |             |
| AfterBlockCompletion |               |             |


# Context Strategy

```kotlin
enum class CodeContextStrategy {
    /**
     * the AutoDev with pre-build context for un-support language
     */
    SIMILAR_CHUNKS,

    /**
     * the AutoDev with pre-build context
     */
    RELATED_CODE;

    fun builder(context: JobContext): CodeContextBuilder<out Any> {
        return mapOf(
            SIMILAR_CHUNKS to SimilarChunksCompletionBuilder(context),
            RELATED_CODE to RelatedCodeCompletionBuilder(context),
        )[this] ?: throw SerializationException("Unknown message type: $this")
    }
}
```

# Completion Type

```kotlin
enum class CompletionBuilderType {
    // TODO: support in future for this
    INLINE_COMPLETION,
    IN_BLOCK_COMPLETION,
    AFTER_BLOCK_COMPLETION;

    fun builder(context: JobContext): CompletionBuilder {
        return mapOf(
            INLINE_COMPLETION to InlineCodeCompletionBuilder(context),
            IN_BLOCK_COMPLETION to InBlockCodeCompletionBuilder(context),
            AFTER_BLOCK_COMPLETION to AfterBlockCodeCompletionBuilder(context),
        )[this] ?: throw SerializationException("Unknown message type: $this")
    }
}
```

